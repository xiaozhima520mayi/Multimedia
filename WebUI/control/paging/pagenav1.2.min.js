/*
*调用示例
*        
$(function () {
$("#pageNav").pager({ pagenumber: 1, pagecount: 1, buttonPageCallback: buttonPageClick });
});
buttonPageClick = function (e) {
$("#pageNav").pager({ pagenumber: parseInt(e), pagecount: 1, buttonPageCallback: buttonPageClick });
}
*
*/
(function ($) {
    $.fn.pager2 = function (options) {
        //pageNumCount 为显示多少条页码数
        //pageForward  为每次加载页码数
        var setting = { pagenumber: 0, pagecount: 0, prev: "<<", next: ">>", pageNumCount: 5, pageForward: 2 };
        setting = $.extend(setting, options);
        if (setting.pagecount <= 1) {
            $(this).html("");
            return;
        }
        var a = parseInt(setting.pagenumber);
        var b = parseInt(setting.pagecount);
        if (1 >= b) {
            return this.pn = this.p = 1, pHtml2(1, b);
        }
        b < a && (a = b); var c = "";
        1 >= a ? a = 1 : (c += createButton2(a - 1, b, setting.prev, options.buttonPageCallback), c += createButton2(1, b, "", options.buttonPageCallback));
        this.p = a;
        this.pn = b;
        //A.
        var d = 2, e = setting.pageNumCount > b ? b : setting.pageNumCount;
        //B.
        5 <= a && (c += "<span>...</span>", d = a - setting.pageForward, e = a + setting.pageForward, e = b < e ? b : e);
        for (; d < a; d++) c += createButton2(d, b, "", options.buttonPageCallback);
        c += pHtml2(a, b);
        for (d = a + 1; d <= e; d++)
            c += createButton2(d, b, "", options.buttonPageCallback);
        e < b && (c = c + "<span>...</span>" + createButton2(b, b, "", options.buttonPageCallback));
        a < b && (c += createButton2(a + 1, b, setting.next, options.buttonPageCallback));
        $(this).html(c);
        $(this).find("a").click(function () {
            if ($(this).attr("page") != null)
                setting.buttonPageCallback($(this).attr("page"));
        });
    }
    pHtml2 = function (a, b) { return (b == 1 || b == 0) ? "" : " <a class='e'>" + a + "</a> "; }
    function createButton2(pagenumber, pagecount, btn, buttonPageCallback) {
        var className = "";
        if (btn != "") className = btn == "<<" ? "last" : "next";
        btn = btn == "" ? pagenumber : btn;
        return " <a href=\"javascript://\" page='" + pagenumber + "' class='" + className + "'>" + (btn) + "</a> ";
    }
} (jQuery));
